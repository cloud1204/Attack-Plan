{"scoring":"\\begin{itemize}\r\n  \\item $1 \\leq n, m \\leq 10^5$。\r\n  \\item $1 \\leq b_i \\leq a_i \\leq 10^{9}$（$1 \\leq i \\leq n$）。\r\n  \\item $1 \\leq w_i \\leq 10^4$（$1 \\le i \\leq m$）。\r\n  \\item $1 \\leq u_i, v_i \\leq n$（$1 \\leq i \\leq m$）。\r\n  \\item $u_i \\neq v_i$（$1 \\leq i \\leq m$）。\r\n  \\item 所有輸入都是整數。\r\n\\end{itemize}\r\n\r\n\\begin{center}\r\n\\begin{tabular}{ccl} \\hline\r\n  \\bf{子任務} & \\bf{分數} & \\bf{額外輸入限制} \\\\ \\hline\r\n  $1$ & $32$ & $m = n-1$。\\\\\r\n  $2$ & $29$ & $a_i = b_i$（$1 \\leq i \\leq n$）。\\\\\r\n  $3$ & $15$ & $n, m \\leq 100$、$b_i \\leq a_i \\leq 100$（$1 \\leq i \\le n$）、$w_i \\leq 100$（$1 \\leq i \\leq m$）。\\\\\r\n  $4$ & $24$ & 無額外限制。\\\\\r\n\\hline \\end{tabular}\r\n\\end{center}\r\n","notes":"以下為範測二的最佳解流程：\r\n\r\n\\begin{itemize}\r\n  \\item 第 $0$ 秒：$4$ 個人都在據點 $2$；派 $1$ 個人進攻，$3$ 個人往據點 $3$ 移動。\r\n\r\n  \\item 第 $2$ 秒：$3$ 個人抵達據點 $3$；派 $1$ 個人進攻，$1$ 個人往據點 $1$ 移動，$1$ 個人往據點 $4$ 移動。\r\n\r\n  \\item 第 $5$ 秒：據點 $2$ 的人與據點 $3$ 的人完成進攻了。與此同時，$1$ 個人抵達據點 $1$ 並原地開始進攻。\r\n\r\n  \\item 第 $7$ 秒：據點 $1$ 的人完成進攻了。與此同時，$1$ 個人抵達據點 $4$ 並原地開始進攻。\r\n\r\n  \\item 第 $8$ 秒：據點 $4$ 的人完成進攻了。\r\n\\end{itemize}\r\n","legend":"敵人共有 $n$ 個據點，由 $m$ 條雙向道路互相連接。第 $i$ 條道路連接的是第 $u_i$ 個和第 $v_i$ 個據點，且該道路的長度為 $w_i$，代表要通過該道路需要花費 $w_i$ 秒。保證任意兩個據點之間都是直接或間接的連接的。\r\n\r\n現在，你組織了一個 $n$ 個人的部隊，想要佔領敵人全部的據點。一開始（第 $0$ 秒時），所有人都在第 $s$ 個據點。\r\n\r\n每個據點都有兩個數值代表其進攻的難度；當兵隊抵達第 $i$ 個據點的時候，根據抵達的小隊人數是否大於一，執行下列兩種操作之一：\r\n\r\n\\begin{enumerate}\r\n  \\item 如果小隊人數至少有兩個人或更多，則派遣部隊的其中一個人開始進攻該據點，其餘人繼續移動。留下來的那個人將會花 $a_i$ 秒（從他開始進攻的時間算起）成功佔領據點。\r\n\r\n  \\item 如果小隊人數只有一人，則直接開始進攻該據點。已知他將會花 $b_i$ 秒（從他開始進攻的時間算起）成功佔領該據點。\r\n\\end{enumerate}\r\n\r\n因為被小隊拋下一個人進攻會很不甘情願，所以對於每個據點都滿足 $a_i \\geq b_i$ 的性質。\r\n\r\n在兵隊移動的時候，你可以自由指揮。兵分多路的時候，每個路拆分出來的小隊人數將由你自由決定（其中幾條路也可以 $0$ 個人走）。需要特別注意的規則是：你無法讓一個小隊移動到有人正在進攻或是已經進攻完成的據點，也不能讓兩個小隊同時抵達同一個據點。\r\n\r\n在你的精心指揮下，最快需要幾秒才可以將所有據點都佔領？\r\n","authorLogin":"Clouder","language":"english","timeLimit":3000,"output":"輸出一個整數：將所有據點都攻佔完畢的最短時間。\r\n","inputFile":"stdin","outputFile":"stdout","input":"第 $1$ 行：$n \\;\\; m \\;\\; s$\r\n\r\n第 $2$ 行：$a_1 \\;\\; a_2 \\;\\; a_3 \\;\\; \\ldots \\;\\; a_n$\r\n\r\n第 $3$ 行：$b_1 \\;\\; b_2 \\;\\; b_3 \\;\\; \\ldots \\;\\; b_n$\r\n\r\n第 $3+i$ 行（$1 \\le i \\le m$）：$u_i \\;\\; v_i \\;\\; w_i$\r\n","authorName":"Daniel Chiang","sampleTests":[{"output":"12\r\n","input":"5 4 1\r\n4 2 7 4 9\r\n3 2 4 2 5\r\n1 2 2\r\n1 3 8\r\n2 4 3\r\n2 5 5\r\n","inputFile":"example.01","outputFile":"example.01.a"},{"output":"8\r\n","input":"4 5 2\r\n8 5 1 10\r\n2 2 1 1\r\n2 1 2\r\n2 3 4\r\n1 4 3\r\n4 3 3\r\n1 3 1\r\n","inputFile":"example.02","outputFile":"example.02.a"}],"name":"攻城計畫 (attackplan)","interaction":null,"memoryLimit":268435456,"tutorial":""}